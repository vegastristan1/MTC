SELECT InvWarehouse.StockCode, InvMaster.Description, InvWarehouse.Warehouse,
    FLOOR(ABS(InvWarehouse.QtyOnHand)) AS OnHandCS, ISNULL(FLOOR(ROUND((ABS(InvWarehouse.QtyOnHand) - CAST(FLOOR(ABS(InvWarehouse.QtyOnHand)) AS decimal(15, 2))) * CAST(InvMaster.ConvFactAltUom AS decimal(10, 2)), 0)), 0) AS OnHandPcs,
    FLOOR(ABS(InvWarehouse.QtyAllocated)) AS AllocCS, ISNULL(FLOOR(ROUND((ABS(InvWarehouse.QtyAllocated) - CAST(FLOOR(ABS(InvWarehouse.QtyAllocated)) AS decimal(15, 2))) * CAST(InvMaster.ConvFactAltUom AS decimal(10, 2)), 0)), 0) AS AllocPcs,
    FLOOR(ABS(InvWarehouse.QtyOnHand - InvWarehouse.QtyAllocated + InvWarehouse.QtyOnBackOrder)) AS StockFreeCS, ISNULL(FLOOR(ROUND((ABS(InvWarehouse.QtyOnHand - InvWarehouse.QtyAllocated + InvWarehouse.QtyOnBackOrder) - CAST(FLOOR(ABS(InvWarehouse.QtyOnHand - InvWarehouse.QtyAllocated + InvWarehouse.QtyOnBackOrder)) AS decimal(15, 2))) * CAST(InvMaster.ConvFactAltUom AS decimal(10, 2)), 0)), 0) AS StockFreePCS,
    (InvPrice.SellingPrice*QtyOnHand)*1.12 as [Value],
    ISNULL(InvPrice.SellingPrice/ NULLIF (InvMaster.ConvFactAltUom,0),0) * 1.12 as [Price/PCS],
    InvPrice.SellingPrice * 1.12 as [PriceCS],
    InvMaster.AlternateUom as [Config], InvMaster.ConvFactOthUom as [IB/Cs],
    Case
        When InvWarehouse.QtyAllocated > InvWarehouse.QtyOnHand then 'OFR-OS QTY'
    Else ''
    End As Remarks
        FROM         InvWarehouse INNER JOIN
        InvMaster ON InvWarehouse.StockCode = InvMaster.StockCode
        INNER JOIN InvPrice ON InvWarehouse.StockCode = InvPrice.StockCode
    WHERE (InvWarehouse.QtyOnHand <> 0) and InvMaster.ProductClass not  like 'TS' and InvPrice.PriceCode = '1'
        Order by InvMaster.Description, InvWarehouse.Warehouse

-- ============================================================================
-- NOTES:
-- ============================================================================

-- 1. PRICE CODE FILTER:
--    InvPrice.PriceCode is filtered to '1' for selling price only
--    Can be modified to other PriceCode values:
--    - 1: Selling Price
--    - 3: Cost Price
--    - 4: Wholesale Price
--    - 99: Other Price

-- 2. WAREHOUSE FILTER:
--    Warehouse filter can be added if specific warehouse is needed
--    Example: Add "AND InvWarehouse.Warehouse = 'MR'" to filter by MR warehouse
--    Common warehouse codes: MR, FG, WH, 01, 02, 03, 04, 05, etc.

-- 3. PRODUCT CLASS FILTER:
--    InvMaster.ProductClass not like 'TS' excludes TS (Traded Stock) items
--    Remove or modify this filter if needed

-- 4. EXCLUDED ITEMS:
--    InvWarehouse.QtyOnHand <> 0 excludes items with zero on-hand quantity
